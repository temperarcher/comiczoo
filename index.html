<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<title>ComicZoo – Login</title>

<!-- Firebase COMPAT -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
body {
  font-family: Arial, sans-serif;
  background: #f4f4f4;
  padding: 40px;
}
.card {
  background: white;
  padding: 20px;
  max-width: 400px;
  margin: auto;
  border-radius: 8px;
}
input, button {
  width: 100%;
  padding: 10px;
  margin: 6px 0;
}
</style>
</head>

<body>

<div class="card" id="auth">
  <h2>Login / Registrazione</h2>
  <input id="email" type="email" placeholder="Email">
  <input id="password" type="password" placeholder="Password">
  <button onclick="login()">Login</button>
  <button onclick="register()">Registrati</button>
</div>

<div class="card" id="app" style="display:none">
  <h2>✅ Sei loggato</h2>
  <p id="userEmail"></p>
  <button onclick="logout()">Logout</button>
</div>

<script>
/* ===============================
   CONFIG
================================ */
const firebaseConfig = {
  apiKey: "AIzaSyCMWWtqeymGjCxQiQbGcIEZUAEkhaUt-TI",
  authDomain: "comiczoo.firebaseapp.com",
  projectId: "comiczoo"
};

firebase.initializeApp(firebaseConfig);

const auth = firebase.auth();
const db   = firebase.firestore();

/* ===============================
   UI
================================ */
const authDiv = document.getElementById("auth");
const appDiv  = document.getElementById("app");
const userEmail = document.getElementById("userEmail");

/* ===============================
   AUTH STATE
================================ */
auth.onAuthStateChanged(user => {
  if (user) {
    authDiv.style.display = "none";
    appDiv.style.display  = "block";
    userEmail.textContent = user.email;
    loadSerie();
  } else {
    authDiv.style.display = "block";
    appDiv.style.display  = "none";
  }
});

/* ===============================
   AUTH FUNCTIONS
================================ */
function login() {
  auth.signInWithEmailAndPassword(email.value,password.value)
    .catch(e=>alert(e.message));
}

function register() {
  auth.createUserWithEmailAndPassword(email.value,password.value)
    .catch(e=>alert(e.message));
}

function logout() {
  auth.signOut();
}

/* ===============================
   SERIE
================================ */
function loadSerie() {
  db.collection("serie").get().then(snap => {
    const list = document.getElementById("serieList");
    list.innerHTML = "";
    snap.forEach(doc => {
      const s = doc.data();
      list.innerHTML += `
        <div style="border:1px solid #ccc;padding:10px;margin:5px">
          <b>${s.titolo}</b><br>
          ${s.genere || ""}
        </div>
      `;
    });
  });
}
</script>


</body>
</html>
